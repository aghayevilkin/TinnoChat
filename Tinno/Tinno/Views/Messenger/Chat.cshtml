@model VmBase
@inject UserManager<IdentityUser> userManager
@{
    ViewData["Title"] = "Chat";
    Layout = "~/Views/Shared/_Layout.cshtml";
}

<!-- chat -->
<div class="chat chat-page">
    <!-- no-message -->
    <div class="chat-preloader d-none">
        <div class="spinner-border" role="status">
            <span class="sr-only">Loading...</span>
        </div>
    </div>
    <div class="no-message-container">
        <div class="row mb-5">
            <div class="col-md-4 offset-4">
                <img src="~/media/svg/chat_empty.svg" class="img-fluid" alt="image">
            </div>
        </div>
        <p class="lead">Choose a chat or start a <a href="#" data-left-sidebar="friends">new chat</a>.</p>
    </div>
    <div class="chat-header">
        <div class="chat-header-user">
            @if (ViewBag.Friend.Image != null)
            {
                <figure id="@ViewBag.Friend.Id" class="avatar @(ViewBag.Friend.IsActive == true?"avatar-state-success":"") mr-3">
                    <img src="~/Uploads/Images/Accounts/@ViewBag.Friend.Image" class="rounded-circle" alt="image">
                </figure>
            }
            else
            {
                <figure id="@ViewBag.Friend.Id" class="avatar @(ViewBag.Friend.IsActive == true?"avatar-state-success":"") mr-3">
                    <span class="avatar-title bg-secondary rounded-circle">@ViewBag.FriendNameSubstring</span>
                </figure>
            }
            <div>
                <h5>@ViewBag.Friend.Name @ViewBag.Friend.Surname</h5>
                <small id="isActive" class="@(ViewBag.Friend.IsActive == true?"text-success":"text-danger")">@(ViewBag.Friend.IsActive == true?"Online":"Offline")</small>

            </div>
        </div>
        <div class="chat-header-action">
            <ul class="list-inline" data-intro-js="7">
                <li class="list-inline-item d-inline d-lg-none">
                    <a href="#" class="btn btn-danger btn-floating example-chat-close">
                        <i class="mdi mdi-arrow-left"></i>
                    </a>
                </li>
                <li class="list-inline-item" data-toggle="tooltip" title="Voice call">
                    <a href="#" class="btn btn-info btn-floating" data-right-sidebar="notifications">
                        <i class="mdi mdi-bell-outline"></i>
                    </a>
                </li>
                <li class="list-inline-item" data-toggle="tooltip" title="Voice call">
                    <a href="#" class="btn btn-success btn-floating voice-call-request">
                        <i class="mdi mdi-phone"></i>
                    </a>
                </li>
                <li class="list-inline-item" data-toggle="tooltip" title="Video call">
                    <a href="#" class="btn btn-warning btn-floating video-call-request">
                        <i class="mdi mdi-video-outline"></i>
                    </a>
                </li>
                <li class="list-inline-item">
                    <a href="#" class="btn btn-dark btn-floating" data-toggle="dropdown">
                        <i class="mdi mdi-dots-horizontal"></i>
                    </a>
                    <div class="dropdown-menu dropdown-menu-right">
                        <a href="#" data-right-sidebar="user-profile" class="dropdown-item">Profile</a>
                        <a href="#" class="dropdown-item example-close-selected-chat">Close chat</a>
                        <a href="#" class="dropdown-item">Add to archive</a>
                        <a href="#" class="dropdown-item example-delete-chat">Delete</a>
                        <div class="dropdown-divider"></div>
                        <a href="#" class="dropdown-item text-danger example-block-user">Block</a>
                    </div>
                </li>
            </ul>
        </div>
    </div>
    <div class="chat-body cont">
        <div class="messages" id="message-box">
            @foreach (var message in Model.Messages)
            {
                if (ViewBag.Friend.Id == message.SenderId)
                {
                    <div class="message-item in">
                        <div class="message-content">
                            <div class="message-text">@message.MessageText
                                <div class="time mt-2">@message.Date.ToString("dd.MM.yyyy HH:mm")</div></div>
                        </div>
                    </div>
                }
                else
                {
                    <div class="message-item out">
                        <div class="message-content">
                            <div class="message-text">@message.MessageText
                                <div class="time mt-2">@message.Date.ToString("dd.MM.yyyy HH:mm")</div>
                            </div>
                        </div>
                    </div>
                }

            }


            @*<div class="message-item messages-divider" data-label="1 message unread"></div>*@

            @*<div class="message-item in in-typing">
                <div class="message-content">
                    <div class="message-text">
                        <div class="writing-animation">
                            <div class="writing-animation-line"></div>
                            <div class="writing-animation-line"></div>
                            <div class="writing-animation-line"></div>
                        </div>
                    </div>
                </div>
            </div>*@
        </div>
    </div>
    <div class="chat-footer" data-intro-js="6">
        <form class="d-flex">
            <div class="dropdown">
                <button class="btn btn-light-info btn-floating mr-3" data-toggle="dropdown" title="Emoji"
                        type="button">
                    <i class="mdi mdi-face"></i>
                </button>
                <div class="dropdown-menu dropdown-menu-big p-0">
                    <div class="dropdown-menu-search">
                        <input type="text" class="form-control" placeholder="Search emoji">
                    </div>
                    <div class="emojis chat-emojis">
                        <ul>
                            <li>😁</li>
                            <li>😂</li>
                            <li>😃</li>
                            <li>😄</li>
                            <li>😅</li>
                            <li>😆</li>
                            <li>😉</li>
                            <li>😊</li>
                            <li>😋</li>
                            <li>😌</li>
                            <li>😍</li>
                            <li>😏</li>
                            <li>😒</li>
                            <li>😓</li>
                            <li>😔</li>
                            <li>😖</li>
                            <li>😘</li>
                            <li>😝</li>
                            <li>😠</li>
                            <li>😢</li>
                            <li>🙅</li>
                            <li>🙆</li>
                            <li>🙇</li>
                            <li>🙈</li>
                            <li>🙉</li>
                            <li>🙊</li>
                            <li>🙋</li>
                            <li>🙌</li>
                            <li>🙍</li>
                            <li>🙎</li>
                            <li>🙏</li>
                        </ul>
                    </div>
                </div>
            </div>
            <div class="dropdown">
                <button class="btn btn-light-info btn-floating mr-3" data-toggle="dropdown" title="Emoji"
                        type="button">
                    <i class="mdi mdi-plus"></i>
                </button>
                <div class="dropdown-menu">
                    <a href="#" class="dropdown-item">Location</a>
                    <a href="#" class="dropdown-item">Attach</a>
                    <a href="#" class="dropdown-item">Document</a>
                    <a href="#" class="dropdown-item">File</a>
                    <a href="#" class="dropdown-item">Video</a>
                </div>
            </div>

            <div id="message-input" style="width:100%">
                <input type="text" id="message" class="form-control form-control-main" placeholder="Write a message.">
                <input hidden id="friend-id" value="@ViewBag.Friend.Id" />
            </div>
            <button class="btn btn-primary ml-2 btn-floating" id="sendButton">
                <i class="mdi mdi-send"></i>
            </button>
        </form>
    </div>
</div>
<!-- ./ chat -->